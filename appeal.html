<!DOCTYPE html>
<html lang="ru">
	<head>
		<!-- Google tag (gtag.js) -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=G-VFFJE5E6D4"
		></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "G-VFFJE5E6D4");
		</script>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>–û–±–∂–∞–ª–æ–≤–∞–Ω–∏–µ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –ø–∞—Ä–∫–æ–≤–∫—É</title>
		<script src="https://telegram.org/js/telegram-web-app.js"></script>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
					Roboto, Helvetica, Arial, sans-serif;
				background-color: var(--tg-theme-bg-color, #ffffff);
				color: var(--tg-theme-text-color, #000000);
				padding: 20px;
				max-width: 600px;
				margin: 0 auto;
				padding-bottom: 40px;
			}

			.back-button {
				margin-bottom: 20px;
			}

			.back-button a {
				display: inline-flex;
				align-items: center;
				gap: 6px;
				padding: 8px 12px;
				background-color: var(--tg-theme-secondary-bg-color, #f5f5f5);
				color: var(--tg-theme-text-color, #000000);
				text-decoration: none;
				border-radius: 8px;
				font-size: 15px;
				transition: opacity 0.2s ease;
			}

			.back-button a:active {
				opacity: 0.7;
			}

			h1 {
				font-size: 24px;
				margin-bottom: 8px;
				color: var(--tg-theme-text-color, #000000);
			}

			.subtitle {
				font-size: 15px;
				color: var(--tg-theme-hint-color, #999999);
				margin-bottom: 24px;
				line-height: 1.4;
			}

			.info-card {
				background-color: var(--tg-theme-secondary-bg-color, #f5f5f5);
				border-radius: 12px;
				padding: 16px;
				margin-bottom: 20px;
				font-size: 14px;
				line-height: 1.5;
				color: var(--tg-theme-text-color, #000000);
			}

			.info-card strong {
				color: var(--tg-theme-button-color, #3390ec);
			}

			.container {
				background-color: var(--tg-theme-secondary-bg-color, #f5f5f5);
				border-radius: 12px;
				padding: 20px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				margin-bottom: 20px;
			}

			.form-section {
				margin-bottom: 24px;
			}

			.form-section h2 {
				font-size: 18px;
				margin-bottom: 16px;
				color: var(--tg-theme-text-color, #000000);
			}

			.form-group {
				margin-bottom: 16px;
			}

			label {
				display: block;
				margin-bottom: 8px;
				font-weight: 500;
				font-size: 15px;
				color: var(--tg-theme-text-color, #000000);
			}

			input[type="text"],
			input[type="date"] {
				width: 100%;
				padding: 12px;
				border: 1px solid var(--tg-theme-hint-color, #ccc);
				border-radius: 10px;
				font-size: 16px;
				background-color: var(--tg-theme-bg-color, #ffffff);
				color: var(--tg-theme-text-color, #000000);
			}

			input[type="text"]:focus,
			input[type="date"]:focus {
				outline: none;
				border-color: var(--tg-theme-button-color, #3390ec);
			}

			.preview-section {
				margin-top: 24px;
			}

			.preview-section h2 {
				font-size: 18px;
				margin-bottom: 12px;
				color: var(--tg-theme-text-color, #000000);
			}

			.preview-box {
				background-color: var(--tg-theme-bg-color, #ffffff);
				border: 1px solid var(--tg-theme-hint-color, #ccc);
				border-radius: 10px;
				padding: 16px;
				font-size: 15px;
				line-height: 1.6;
				white-space: pre-wrap;
				color: var(--tg-theme-text-color, #000000);
				min-height: 300px;
				margin-bottom: 16px;
			}

			.copy-button {
				width: 100%;
				padding: 14px;
				background-color: var(--tg-theme-button-color, #3390ec);
				color: var(--tg-theme-button-text-color, #ffffff);
				border: none;
				border-radius: 10px;
				font-size: 16px;
				font-weight: 500;
				cursor: pointer;
				transition: opacity 0.2s ease;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 8px;
			}

			.copy-button:active {
				opacity: 0.8;
			}

			.copy-button.success {
				background-color: #4caf50;
			}

			.hint {
				font-size: 13px;
				color: var(--tg-theme-hint-color, #999999);
				margin-top: 6px;
			}

			.required {
				color: #ff6b6b;
			}
		</style>
	</head>
	<body>
		<div class="back-button">
			<a href="index.html">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—É</a>
		</div>

		<h1>üìù –û–±–∂–∞–ª–æ–≤–∞–Ω–∏–µ —à—Ç—Ä–∞—Ñ–∞</h1>
		<div class="subtitle">
			–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞—è–≤–ª–µ–Ω–∏—è –¥–ª—è –æ—Ç–º–µ–Ω—ã —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –ø–∞—Ä–∫–æ–≤–∫—É –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤
			—ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–µ–π
		</div>

		<div class="info-card">
			<strong>‚ÑπÔ∏è –°–ø—Ä–∞–≤–∫–∞:</strong> –í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º –†–ö,
			–≤–ª–∞–¥–µ–ª—å—Ü—ã —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–µ–π –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –ø–∞—Ä–∫–æ–≤–∫—É –≤
			–º–µ—Å—Ç–∞—Ö, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.
		</div>

		<div class="info-card">
			<strong>üìù –ö–∞–∫ –ø–æ–¥–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ:</strong><br />
			1. –í–æ–π–¥–∏—Ç–µ –Ω–∞
			<a
				href="https://erap-public.kgp.kz/#/login"
				target="_blank"
				style="color: var(--tg-theme-link-color, #3390ec)"
				>erap-public.kgp.kz</a
			><br />
			2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª
			<a
				href="https://erap-public.kgp.kz/#/main/complaint"
				target="_blank"
				style="color: var(--tg-theme-link-color, #3390ec)"
				>¬´–û–±—Ä–∞—â–µ–Ω–∏–µ¬ª</a
			><br />
			3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏—è –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ü–æ–∏—Å–∫¬ª<br />
			4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´–ü–æ–¥–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ¬ª<br />
			5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –≤ –ø—É–Ω–∫—Ç 2.3
		</div>

		<div class="container">
			<div class="form-section">
				<h2>üìã –î–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞—è–≤–ª–µ–Ω–∏—è</h2>

				<div class="form-group">
					<label for="fullName"
						>–ü–æ–ª–Ω–æ–µ –∏–º—è <span class="required">*</span></label
					>
					<input
						type="text"
						id="fullName"
						placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"
					/>
					<div class="hint">–§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ</div>
				</div>

				<div class="form-group">
					<label for="plateNumber"
						>–ì–æ—Å. –Ω–æ–º–µ—Ä <span class="required">*</span></label
					>
					<input
						type="text"
						id="plateNumber"
						placeholder="123ABC01"
					/>
					<div class="hint">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è</div>
				</div>

				<div class="form-group">
					<label for="certSerial"
						>–°–µ—Ä–∏—è —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞ –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¢–°
						<span class="required">*</span></label
					>
					<input
						type="text"
						id="certSerial"
						placeholder="AB1234567"
					/>
					<div class="hint">
						–°–µ—Ä–∏—è —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞ –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞
					</div>
				</div>

				<div class="form-group">
					<label for="fineNumber"
						>‚Ññ –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏—è <span class="required">*</span></label
					>
					<input type="text" id="fineNumber" placeholder="12345678" />
					<div class="hint">–ù–æ–º–µ—Ä —à—Ç—Ä–∞—Ñ–Ω–æ–≥–æ –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏—è</div>
				</div>

				<div class="form-group">
					<label for="fineDate"
						>–î–∞—Ç–∞ —à—Ç—Ä–∞—Ñ–∞ <span class="required">*</span></label
					>
					<input type="date" id="fineDate" />
				</div>

				<div class="form-group">
					<label for="location"
						>–ú–µ—Å—Ç–æ –ø–∞—Ä–∫–æ–≤–∫–∏ <span class="required">*</span></label
					>
					<input
						type="text"
						id="location"
						placeholder="–≥. –ê–ª–º–∞—Ç—ã, —É–ª. –ê–±–∞—è, 150"
					/>
					<div class="hint">–ê–¥—Ä–µ—Å, –≥–¥–µ –±—ã–ª –≤—ã–ø–∏—Å–∞–Ω —à—Ç—Ä–∞—Ñ</div>
				</div>
			</div>

			<div class="preview-section">
				<h2>üìÑ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
				<div class="preview-box" id="previewBox">
					–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –≤—ã—à–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ç–µ–∫—Å—Ç –∑–∞—è–≤–ª–µ–Ω–∏—è...
				</div>
				<button class="copy-button" id="copyButton">
					üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
				</button>
			</div>
		</div>

		<script>
			// Initialize Telegram WebApp
			let tg = window.Telegram.WebApp;
			tg.expand();
			tg.ready();

			// Apply Telegram theme
			document.body.style.backgroundColor =
				tg.themeParams.bg_color || "#ffffff";

			// Enable BackButton in Telegram
			if (tg.BackButton) {
				tg.BackButton.show();
				tg.BackButton.onClick(function () {
					window.location.href = "index.html";
				});
			}

			// Check version and load saved data from Cloud Storage
			const version = parseFloat(tg.version || "6.0");
			if (version >= 6.9 && tg.CloudStorage) {
				tg.CloudStorage.getItem("appealData", function (err, value) {
					if (!err && value) {
						try {
							const data = JSON.parse(value);
							if (data.fullName)
								document.getElementById("fullName").value =
									data.fullName;
							if (data.plateNumber)
								document.getElementById("plateNumber").value =
									data.plateNumber;
							if (data.certSerial)
								document.getElementById("certSerial").value =
									data.certSerial;
							// Don't load fine-specific data (number, date, location) as they change each time
							updatePreview();
						} catch (e) {
							console.error("Error loading saved data:", e);
						}
					}
				});
			}

			function formatDate(dateString) {
				if (!dateString) return "____________";
				const date = new Date(dateString);
				const day = String(date.getDate()).padStart(2, "0");
				const month = String(date.getMonth() + 1).padStart(2, "0");
				const year = date.getFullYear();
				return `${day}.${month}.${year}`;
			}

			function updatePreview() {
				const fullName =
					document.getElementById("fullName").value.trim() ||
					"________________";
				const plateNumber =
					document.getElementById("plateNumber").value.trim() ||
					"________________";
				const certSerial =
					document.getElementById("certSerial").value.trim() ||
					"________________";
				const fineNumber =
					document.getElementById("fineNumber").value.trim() ||
					"__________________";
				const fineDate = formatDate(
					document.getElementById("fineDate").value
				);
				const location =
					document.getElementById("location").value.trim() ||
					"__________________";

				const previewText = `–Ø, ${fullName}, —è–≤–ª—è—é—Å—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª—è, –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä ${plateNumber}, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ–º –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–µ—Ä–∏—è ${certSerial}.

–í –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –º–µ–Ω—è –±—ã–ª–æ –≤—ã–Ω–µ—Å–µ–Ω–æ –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏–µ ‚Ññ ${fineNumber} –æ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–∏ –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –Ω–µ–æ–ø–ª–∞—Ç—É –ø–∞—Ä–∫–æ–≤–∫–∏ –ø–æ –∞–¥—Ä–µ—Å—É: ${location}, (–¥–∞—Ç–∞) ${fineDate}.

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω, –≤–ª–∞–¥–µ–ª—å—Ü—ã —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–µ–π –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –ø–∞—Ä–∫–æ–≤–∫—É –≤ –º–µ—Å—Ç–∞—Ö, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.

–ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω–æ–≥–æ, –ø—Ä–æ—à—É:

- –û—Ç–º–µ–Ω–∏—Ç—å –ø—Ä–µ–¥–ø–∏—Å–∞–Ω–∏–µ ‚Ññ ${fineNumber} –æ—Ç ${fineDate} –≥.
- –ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ª—É –æ–± –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –ø—Ä–∞–≤–æ–Ω–∞—Ä—É—à–µ–Ω–∏–∏ –≤ —Å–≤—è–∑–∏ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º —Å–æ—Å—Ç–∞–≤–∞ –ø—Ä–∞–≤–æ–Ω–∞—Ä—É—à–µ–Ω–∏—è.`;

				document.getElementById("previewBox").textContent = previewText;

				// Save user data to Cloud Storage (not fine-specific data)
				saveUserData();
			}

			function saveUserData() {
				const fullName = document
					.getElementById("fullName")
					.value.trim();
				const plateNumber = document
					.getElementById("plateNumber")
					.value.trim();
				const certSerial = document
					.getElementById("certSerial")
					.value.trim();

				if (!fullName && !plateNumber && !certSerial) return;

				const data = {
					fullName: fullName,
					plateNumber: plateNumber,
					certSerial: certSerial,
				};

				const version = parseFloat(tg.version || "6.0");
				if (version >= 6.9 && tg.CloudStorage) {
					tg.CloudStorage.setItem("appealData", JSON.stringify(data));
				}
			}

			function copyToClipboard() {
				const text = document.getElementById("previewBox").textContent;

				// Check if all required fields are filled
				if (
					text.includes("________________") ||
					text.includes("__________________")
				) {
					alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è");
					return;
				}

				// Copy to clipboard
				if (navigator.clipboard && navigator.clipboard.writeText) {
					navigator.clipboard
						.writeText(text)
						.then(function () {
							showCopySuccess();
						})
						.catch(function (err) {
							console.error("Failed to copy:", err);
							fallbackCopy(text);
						});
				} else {
					fallbackCopy(text);
				}
			}

			function fallbackCopy(text) {
				const textarea = document.createElement("textarea");
				textarea.value = text;
				textarea.style.position = "fixed";
				textarea.style.opacity = "0";
				document.body.appendChild(textarea);
				textarea.select();
				try {
					document.execCommand("copy");
					showCopySuccess();
				} catch (err) {
					console.error("Fallback copy failed:", err);
					alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç");
				}
				document.body.removeChild(textarea);
			}

			function showCopySuccess() {
				const button = document.getElementById("copyButton");
				button.textContent = "‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";
				button.classList.add("success");

				setTimeout(function () {
					button.textContent = "üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç";
					button.classList.remove("success");
				}, 2000);
			}

			// Add event listeners to all inputs for live preview
			const inputIds = [
				"fullName",
				"plateNumber",
				"certSerial",
				"fineNumber",
				"fineDate",
				"location",
			];
			inputIds.forEach(function (id) {
				document
					.getElementById(id)
					.addEventListener("input", updatePreview);
			});

			// Add copy button listener
			document
				.getElementById("copyButton")
				.addEventListener("click", copyToClipboard);

			// Initial preview update
			updatePreview();
		</script>
	</body>
</html>
